<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Solve transportation problem by Aurenhammer--Hoffmann--Aronov Method."><!-- Inform modern browsers that this page supports both dark and light color schemes,
  and the page author prefers light. --><meta name="color-scheme" content="dark light"><script>
  // If `prefers-color-scheme` is not supported, fall back to light mode.
  // i.e. In this case, inject the `light` CSS before the others, with
  // no media filter so that it will be downloaded with highest priority.
  if (window.matchMedia("(prefers-color-scheme: dark)").media === "not all") {
    document.documentElement.style.display = "none";
    document.head.insertAdjacentHTML(
      "beforeend",
      "<link id=\"css\" rel=\"stylesheet\" href=\"https://bootswatch.com/5/flatly/bootstrap.css\" onload=\"document.documentElement.style.display = ''\">"
    );
  }
</script><title>Solve Transportation Problem by Aurenhammer--Hoffmann--Aronov Method — aha • transport</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Solve Transportation Problem by Aurenhammer--Hoffmann--Aronov Method — aha"><meta property="og:description" content="Solve transportation problem by Aurenhammer--Hoffmann--Aronov Method."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Flatly Theme - Light  --><link id="css-light" rel="stylesheet" href="https://bootswatch.com/5/flatly/bootstrap.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><!-- Darkly Theme - Dark --><link id="css-dark" rel="stylesheet" href="https://bootswatch.com/5/darkly/bootstrap.css" media="(prefers-color-scheme: dark)"><!-- preferably CSS --><link rel="stylesheet" href="../preferably.css"><link id="css-code-light" rel="stylesheet" href="../code-color-scheme-light.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><link id="css-code-dark" rel="stylesheet" href="../code-color-scheme-dark.css" media="(prefers-color-scheme: dark)"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">transport</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.14-6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Example-Analysis.html">Example Analysis</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Solve Transportation Problem by Aurenhammer--Hoffmann--Aronov Method</h1>
      
      <div class="d-none name"><code>aha.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Solve transportation problem by Aurenhammer--Hoffmann--Aronov Method.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">aha</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, nscales <span class="op">=</span> <span class="fl">1</span>, scmult <span class="op">=</span> <span class="fl">2</span>, factr <span class="op">=</span> <span class="fl">1e+05</span>, maxit <span class="op">=</span> <span class="fl">10000</span>, powerdiag<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>    wasser <span class="op">=</span> <span class="cn">FALSE</span>, wasser.spt <span class="op">=</span> <span class="cn">NA</span>, approx<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">transport_apply</span><span class="op">(</span><span class="va">a</span>, <span class="va">tplan</span><span class="op">)</span></span>
<span><span class="fu">transport_error</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">tplan</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>a</dt>
<dd><p>an \(m \times n\) matrix. <code>a</code> is treated as a measure on \([0,m] \times [0,n]\) with constant density on each unit square \([i,i+1) \times [j,j+1)\).</p></dd>

  <dt>b</dt>
<dd><p>either a matrix such that <code>dim(a)==dim(b)</code> and <code>sum(a)==sum(b)</code> or a data frame with three variables named <code>x</code>, <code>y</code> and <code>mass</code> such that <code>sum(a)==sum(b$mass)</code>,
    representing a discrete measure on \([0,m]) \times [0,n]\).</p></dd>

  <dt>tplan</dt>
<dd><p>a transference plan from a (to b), typically an optimal transference plan obtained by a call to <code>aha</code>.</p></dd>

  <dt>nscales, scmult</dt>
<dd><p>the number of scales to use for the multiscale approach (the default is \(1\) meaning no multiscale approach), and the factor
    by which the number of pixels in each dimension is multiplied to get from a coarser to the next finer scale.</p></dd>

  <dt>factr, maxit</dt>
<dd><p>parameters passed to the underlying L-BFGS-B algorithm (via the argument <code>control</code> in the R-function <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>).</p></dd>

  <dt>powerdiag</dt>
<dd><p>logical. Instead of an optimal transference plan, should the parameters for the optimal power diagram be returned?</p></dd>

  <dt>wasser</dt>
<dd><p>logical. Instead of an optimal transference plan, should only the \(L_2\)-Wasserstein-distance between <code>a</code> and <code>b</code> be returned?</p></dd>

  <dt>wasser.spt</dt>
<dd><p>the number of support points used to approximate the discrete measure <code>b</code>. Defaults to <code>NA</code> meaning the full set of support
  	points of <code>b</code> is used. If this argument is not <code>NA</code>, <code>wasser</code> is set to <code>TRUE</code>.</p></dd>

  <dt>approx</dt>
<dd><p>logical. If <code>TRUE</code>, an approximation to the objective function is used during optimization.</p></dd>

  <dt>...</dt>
<dd><p>further arguments passed to <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> via its argument <code>control</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function <code>aha</code> implements the algorithm by Aurenhammer, Hoffmann and Aronov (1998) for finding optimal transference plans in terms
  of the squared Euclidean distance in two dimensions. It follows the more detailed description given in Mérigot (2011) and also implements
  the multiscale version presented in the latter paper.</p>  
<p>The functions <code>transport_apply</code> and <code>transport_error</code> serve for checking the accuracy of the transference plan obtained by <code>aha</code>.
  Since this transference plan is obtained by continuous optimization it will not transport exactly to the measure <code>b</code>, but to the measure
  <code>transport_apply(a, tplan)</code>. By <code>transport_error(a, b, tplan)</code> the sum of absolut errors between the transported <code>a</code>-measure and the <code>b</code>-measure is obtained.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>If <code>powerdiag</code> and <code>wasser</code> are both <code>FALSE</code>, a data frame with columns <code>from</code>, <code>to</code> and <code>mass</code>, which specify from which knot to which other knot what amount of mass is sent in the optimal transference plan. Knots are given as indices in terms of the usual column major enumeration of the matrices <code>a</code> and <code>b</code>. There are <code><a href="plot.html">plot</a></code> methods for the classes <code><a href="pgrid.html">pgrid</a></code> and <code><a href="pp.html">pp</a></code>, which can plot this solution.</p>


<p>If <code>powerdiag</code> is TRUE and <code>wasser</code> is <code>FALSE</code>, a list with components <code>xi</code>, <code>eta</code>, <code>w</code> and <code>rect</code>, which specify the parameters for the optimal power diagram in the same format as needed for the function <code><a href="power_diagram.html">power_diagram</a></code>. Note that rect is always <code>c(0,m,0,n)</code>. Since version 0.10-0 the list has a further component <code>wasser.dist</code> containing the Wasserstein distance.</p>


<p>If <code>wasser</code> is <code>TRUE</code>, a data frame with columns <code>wasser.dist</code> and <code>error.bound</code> of length one, where <code>error.bound</code> gives a bound on the absolute error in the Wasserstein distance due to approximating the measure <code>b</code> by a measure on a smaller number of support points.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>F. Aurenhammer, F. Hoffmann and B. Aronov (1998). Minkowski-type theorems and least-squares clustering. Algorithmica 20(1), 61--76.</p>
<p>Q. Mérigot (2011). A multiscale approach to optimal transport. Eurographics Symposium on Geometry Processing 30(5), 1583--1592.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Björn Bähre <a href="mailto:bjobae@gmail.com">bjobae@gmail.com</a> <br>
  (slightly modified by Dominic Schuhmacher <a href="mailto:dschuhm1@uni-goettingen.de">dschuhm1@uni-goettingen.de</a>)</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="transport.html">transport</a></code>, which is a convenient wrapper function for various optimal transportation algorithms.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">aha</span><span class="op">(</span><span class="va">random32a</span><span class="op">$</span><span class="va">mass</span>, <span class="va">random32b</span><span class="op">$</span><span class="va">mass</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">random32a</span>, <span class="va">random32b</span>, <span class="va">res</span>, lwd<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="aha-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">aha</span><span class="op">(</span><span class="va">random64a</span><span class="op">$</span><span class="va">mass</span>, <span class="va">random64b</span><span class="op">$</span><span class="va">mass</span>, nscales<span class="op">=</span><span class="fl">3</span>, scmult<span class="op">=</span><span class="fl">5</span>, wasser.spt<span class="op">=</span><span class="fl">512</span>, approx<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   wasser.dist error.bound</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    13.17158    1.161478</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="copyright">
  <p></p><p>Developed by Dominic Schuhmacher, Björn Bähre, Nicolas Bonneel, Carsten Gottschlich, Valentin Hartmann, Florian Heinemann, Bernhard Schmitzer, Jörn Schrieber.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
  <p class="preferably">Using <a href="https://preferably.amirmasoudabdol.name/?source=footer" class="external-link">preferably</a> template.</p>
</div>

    </footer></div>

  

  

  </body></html>

