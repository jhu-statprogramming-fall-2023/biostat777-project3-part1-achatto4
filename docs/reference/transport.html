<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Given two objects a and b that specify distributions of mass and an object that specifies (a way to compute) costs,
  find the transport plan for going from a to b that minimizes the total cost."><!-- Inform modern browsers that this page supports both dark and light color schemes,
  and the page author prefers light. --><meta name="color-scheme" content="dark light"><script>
  // If `prefers-color-scheme` is not supported, fall back to light mode.
  // i.e. In this case, inject the `light` CSS before the others, with
  // no media filter so that it will be downloaded with highest priority.
  if (window.matchMedia("(prefers-color-scheme: dark)").media === "not all") {
    document.documentElement.style.display = "none";
    document.head.insertAdjacentHTML(
      "beforeend",
      "<link id=\"css\" rel=\"stylesheet\" href=\"https://bootswatch.com/5/flatly/bootstrap.css\" onload=\"document.documentElement.style.display = ''\">"
    );
  }
</script><title>Find Optimal Transport Plan Between Two Objects — transport • transport</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Find Optimal Transport Plan Between Two Objects — transport"><meta property="og:description" content="Given two objects a and b that specify distributions of mass and an object that specifies (a way to compute) costs,
  find the transport plan for going from a to b that minimizes the total cost."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Flatly Theme - Light  --><link id="css-light" rel="stylesheet" href="https://bootswatch.com/5/flatly/bootstrap.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><!-- Darkly Theme - Dark --><link id="css-dark" rel="stylesheet" href="https://bootswatch.com/5/darkly/bootstrap.css" media="(prefers-color-scheme: dark)"><!-- preferably CSS --><link rel="stylesheet" href="../preferably.css"><link id="css-code-light" rel="stylesheet" href="../code-color-scheme-light.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><link id="css-code-dark" rel="stylesheet" href="../code-color-scheme-dark.css" media="(prefers-color-scheme: dark)"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">transport</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.14-6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Example-Analysis.html">Example Analysis</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Find Optimal Transport Plan Between Two Objects</h1>
      
      <div class="d-none name"><code>transport.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given two objects <code>a</code> and <code>b</code> that specify distributions of mass and an object that specifies (a way to compute) costs,
  find the transport plan for going from <code>a</code> to <code>b</code> that minimizes the total cost.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">transport</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">transport</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">costm</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"networkflow"</span>, <span class="st">"shortsimplex"</span>, <span class="st">"revsimplex"</span>,</span>
<span><span class="st">"primaldual"</span><span class="op">)</span>, fullreturn<span class="op">=</span><span class="cn">FALSE</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, threads<span class="op">=</span><span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for pgrid</span></span>
<span><span class="fu">transport</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, p <span class="op">=</span> <span class="cn">NULL</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"networkflow"</span>, <span class="st">"revsimplex"</span>, <span class="st">"shortsimplex"</span>,</span>
<span>  <span class="st">"shielding"</span>, <span class="st">"aha"</span>, <span class="st">"primaldual"</span><span class="op">)</span>, fullreturn<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, threads<span class="op">=</span><span class="fl">1</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for pp</span></span>
<span><span class="fu">transport</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, p <span class="op">=</span> <span class="fl">1</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auction"</span>, <span class="st">"auctionbf"</span>, <span class="st">"networkflow"</span>, <span class="st">"shortsimplex"</span>,</span>
<span>  <span class="st">"revsimplex"</span>, <span class="st">"primaldual"</span><span class="op">)</span>, fullreturn<span class="op">=</span><span class="cn">FALSE</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, threads<span class="op">=</span><span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for wpp</span></span>
<span><span class="fu">transport</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, p <span class="op">=</span> <span class="fl">1</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"networkflow"</span>, <span class="st">"revsimplex"</span>, <span class="st">"shortsimplex"</span>,</span>
<span>  <span class="st">"primaldual"</span><span class="op">)</span>, fullreturn<span class="op">=</span><span class="cn">FALSE</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, threads<span class="op">=</span><span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>a, b</dt>
<dd><p>two objects that describe mass distributions, between which the optimal transport map is to be computed. For the default
    method these are vectors of non-negative values. For the other three methods these are objects of the respective classes.
    It is also possible to have <code>a</code> of class <code>pgrid</code> and <code>b</code> of class <code>wpp</code>.</p></dd>

  <dt>costm</dt>
<dd><p>for the default method a <code>length(a)</code> by <code>length(b)</code> matrix specifying the cost of transporting single
    units of mass between the corresponding source and destination points.</p></dd>

  <dt>p</dt>
<dd><p>for the three specialized methods the power \(\geq 1\) to which the Euclidean distance between points is taken in order
    to compute costs.</p></dd>

  <dt>method</dt>
<dd><p>the name of the algorithm to use. See details below.</p></dd>

  <dt>fullreturn</dt>
<dd><p>A boolean specifying whether the output of the function should also include the dual solution, the optimal transport cost between a and b and the transport plan in matrix form should be returned as well.</p></dd>

  <dt>control</dt>
<dd><p>a named list of parameters for the chosen method or the result of a call to <code><a href="trcontrol.html">trcontrol</a></code>. Any parameters
  	that are not set by the control argument will get reasonable (sometimes problem specific) defaults.</p></dd>

  <dt>threads</dt>
<dd><p>An Integer specifying the number of threads used in parallel computing. Currently only
available for the method "networkflow".</p></dd>

  <dt>...</dt>
<dd><p>currently without effect.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>There is a number of algorithms that are currently implemented and more will be added in future versions of the package. 
  The following is a brief description of each key word used. Much more details can be found in the cited references 
  and in a forthcoming package vignette.</p>
<p><code>aha</code>: The Aurenhammer--Hoffmann--Aronov (1998) method with the multiscale approach presented in Mérigot (2011). The original theory was limited to \(p=2\). We refer by <code>aha</code> also to the extension of the same idea for \(p=1\) as presented in Hartmann and Schuhmacher (2017) and for more general \(p\) (currently not implemented).</p>
<p><code>auction</code>: The auction algorithm by Bertsekas (1988) with epsilon-scaling, see Bertsekas (1992).</p>
<p><code>auctionbf</code>: A refined auction algorithm that combines forward and revers auction, see Bertsekas (1992).</p>  
<p><code>networkflow</code>: The fast implementation of the network simplex algorithm by Nicolas Bonneel based on the LEMON Library (see citations below).</p>  
<p><code>primaldual</code>: The primal-dual algorithm as described in Luenberger (2003, Section 5.9).</p>
<p><code>revsimplex</code>: The revised simplex algorithm as described in Luenberger and Ye (2008, Section 6.4) with various speed improvements, including a multiscale approach.</p>
<p><code>shielding</code>: The shielding (or shortcut) method, as described in Schmitzer (2016).</p>  
<p><code>shortsimplex</code>: The shortlist method based an a revised simplex algorithm, as described in Gottschlich and Schuhmacher (2014).</p>
<p>The order of the <em>default</em> key words specified for the argument <code>method</code> gives a rough idea of the relative efficiency of the algorithms for the corresponding class of objects. For a given <code>a</code> and <code>b</code> the actual computation times may deviate significantly from this order.
  For class <code>pgrid</code> the default method is <code>"auto"</code>, which resolves to <code>"revsimplex"</code> if <code>p</code> is not 2 or the problem is very small, and to <code>"shielding"</code> otherwise.</p>
<p>The following table gives information about the applicability of the various algorithms (or sometimes rather
  their current implementations).</p>  
<p></p><table class="table table"><tr><td></td><td>default</td><td>pgrid</td><td>pp</td><td>wpp</td></tr><tr><td>aha (p=1 or 2!)</td><td>-</td><td>+</td><td>-</td><td>@</td></tr><tr><td>auction</td><td>-</td><td>-</td><td>+</td><td>-</td></tr><tr><td>auctionbf</td><td>-</td><td>-</td><td>+</td><td>-</td></tr><tr><td>networkflow</td><td>+</td><td>+</td><td>+</td><td>+</td></tr><tr><td>primaldual</td><td>*</td><td>*</td><td>*</td><td>+</td></tr><tr><td>revsimplex</td><td>+</td><td>+</td><td>*</td><td>+</td></tr><tr><td>shielding (p=2!)</td><td>-</td><td>+</td><td>-</td><td>-</td></tr><tr><td>shortsimplex</td><td>+</td><td>+</td><td>*</td><td>+</td></tr></table><p>where: + recommended, * applicable (may be slow), - no implementation planned or combination does not make sense; @ indicates that the aha algorithm is available in the special combination where <code>a</code> is a <code>pgrid</code> object and <code>b</code> is a <code>wpp</code> object (and <code>p</code> is 2). For more details on this combination see the function <code><a href="semidiscrete.html">semidiscrete</a></code>.</p>
<p>Each algorithm has certain parameters supplied by the <code>control</code> argument. The following table gives an overview of parameter names and 
  their applicability.</p>  
<p></p><table class="table table"><tr><td></td><td><code>start</code></td><td>multiscale</td><td>individual parameters</td></tr><tr><td><code>aha</code> (\(p=2\)!)</td><td>-</td><td>+</td><td><code>factr</code>, <code>maxit</code></td></tr><tr><td><code>auction</code></td><td>-</td><td>-</td><td><code>lasteps</code>, <code>epsfac</code></td></tr><tr><td><code>auctionbf</code></td><td>-</td><td>-</td><td><code>lasteps</code>, <code>epsfac</code></td></tr><tr><td><code>networkflow</code></td><td>-</td><td>-</td><td></td></tr><tr><td><code>primaldual</code></td><td>-</td><td>-</td><td></td></tr><tr><td><code>revsimplex</code></td><td>+</td><td>+</td><td></td></tr><tr><td><code>shielding</code> (\(p=2\)!)</td><td>-</td><td>+</td><td></td></tr><tr><td><code>shortsimplex</code></td><td>-</td><td>-</td><td><code>slength</code>, <code>kfound</code>, <code>psearched</code></td></tr></table><p><code>start</code> specifies the algorithm for computing a starting solution (if needed). Currently the Modified Row Minimum Rule
  (<code>start="modrowmin"</code>), the North-West Corner Rule (<code>start="nwcorner"</code>) and the method by Russell (1969) (<code>start="russell"</code>)
  are implemented. When <code>start="auto"</code> (the default) the ModRowMin Rule is chosen. However,
  for <code>transport.pgrid</code> and <code>p</code> larger than 1, there are two cases where an automatic multiscale procedure is also performed, i.e. the optimal transport is first computed on coarser grids and information from these solutions is then used for the finer girds.
  This happens for 
  <code>method = "revsimplex"</code>, where a single coarsening at factor <code>scmult=2</code> is performed, and for <code>method = "shielding"</code>, where a number of coarsenings adapted to the dimensions of the array is performed.</p>  
<p>For <code>p=1</code> and <code>method="revsimplex"</code>, as well as <code>p=2</code> and <code>method="aha"</code> there are multiscale versions of
  the corresponding algorithms that allows for finer control via the parameters
  <code>nscales</code>, <code>scmult</code> and <code>returncoarse</code>. The default value of <code>nscales=1</code> suppresses
  the multiscale version. For larger problems it is advisable to use the multiscale version, which currently is only implemented for
  square pgrids in two dimensions. The algorithm proceeds then by coarsening the pgrid <code>nscales-1</code> times, summarizing
  each time <code>scmult^2</code> pixels into one larger pixels, and then solving the various transport problems starting from the coarsest and
  using each previous problem to compute a starting solution to the next finer problem. If <code>returncoarse</code> is <code>TRUE</code>, the coarser
  problems and their solutions are returned as well (<code>revsimplex</code> only).</p>  
<p><code>factr</code>, <code>maxit</code> are the corresponding components of the <code>control</code> argument in the <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> L-BFGS-B method.</p>  
<p><code>lasteps</code>, <code>epsfac</code> are parameters used for epsilon scaling in the auction algortihm. The algorithm starts with a “transaction cost” per bid of <code>epsfac^k * lasteps</code> for some reasonable <code>k</code> generating finer and finer approximate solutions as the <code>k</code> counts down to zero. Note that in order for the procedure to make sense, <code>epsfac</code> should be larger than one (typically two- to three-digit) and in order for the final solution to be exact <code>lasteps</code> should be smaller than <code>1/n</code>, where <code>n</code> is the total number of points in either of the point patterns.
  <code>slength</code>, <code>kfound</code>, <code>psearched</code> are the shortlist length, the number of pivot candidates needed, and the percentage of
  shortlists searched, respectively.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A data frame with columns <code>from</code>, <code>to</code> and <code>mass</code> that specifies from which element of <code>a</code> to which element of <code>b</code> what amount of mass is sent in the optimal transport plan. For class <code>pgrid</code> elements are specified as vector indices in terms of the usual column major enumeration of the matrices <code>a$mass</code> and <code>b$mass</code>. There are <code><a href="plot.html">plot</a></code> methods for the classes <code>pgrid</code> and <code>pp</code>, which can plot this solution.</p>


<p>If <code>returncoarse</code> is <code>TRUE</code> for the <code>revsimplex</code> method, a list with components <code>sol</code> and <code>prob</code> giving the solutions and problems on the various scales considered. The solution on the finest scale (i.e. the output we obtain when setting <code>returncoarse</code> to <code>FALSE</code>) is in <code>sol[[1]]</code>.</p>


<p>If <code>a</code> is of class <code>pgrid</code> and <code>b</code> of class <code>wpp</code> (and <code>p=2</code>), an object of class <code>power_diagram</code> as described in the help for the function <code><a href="semidiscrete.html">semidiscrete</a></code>. The <code><a href="plot.html">plot</a></code> method for class <code>pgrid</code> can plot this solution.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>F. Aurenhammer, F. Hoffmann and B. Aronov (1998). Minkowski-type theorems and least-squares clustering. Algorithmica 20(1), 61--76.</p>
<p>D. P. Bertsekas (1988). The auction algorithm: a distributed relaxation method for the assignment problem. Annals of Operations Research 14(1), 105--123.</p>
<p>D. P. Bertsekas (1992). Auction algorithms for network flow problems: a tutorial introduction. Computational Optimization and Applications 1, 7--66.</p>
<p>N. Bonneel (2018). Fast Network Simplex for Optimal Transport. Github repository, <a href="https://github.com/nbonneel/network_simplex" class="external-link">nbonneel/network_simplex</a>.</p>
<p>N. Bonneel, M. van de Panne, S. Paris and W. Heidrich (2011). Displacement interpolation using Lagrangian mass transport. ACM Transactions on Graphics (SIGGRAPH ASIA 2011) 30(6).</p>
<p>Egervary Research Group on Combinatorial Optimization, EGRES (2014). LEMON Graph Library v1.3.1.
<a href="https://lemon.cs.elte.hu/trac/lemon" class="external-link">lemon.cs.elte.hu/trac/lemon</a>.</p>
<p>C. Gottschlich and D. Schuhmacher (2014). The shortlist method for fast computation of the earth mover's distance and finding optimal solutions to transportation problems. PLOS ONE 9(10), e110214. doi: <a href="https://doi.org/10.1371/journal.pone.0110214" class="external-link">10.1371/journal.pone.0110214</a></p>
<p>V. Hartmann and D. Schuhmacher (2020). Semi-discrete optimal transport: a solution procedure for the unsquared Euclidean distance case, Mathematical Methods of Operations Research 92, 133--163. doi: <a href="https://doi.org/10.1007/s00186-020-00703-z" class="external-link">10.1007/s00186-020-00703-z</a></p>
<p>D.G. Luenberger (2003). Linear and nonlinear programming, 2nd ed. Kluwer.</p>
<p>D.G. Luenberger and Y. Ye (2008). Linear and nonlinear programming, 3rd ed. Springer.</p>
<p>Q. Mérigot (2011). A multiscale approach to optimal transport. Computer Graphics Forum 30(5), 1583--1592. doi: <a href="https://doi.org/10.1111/j.1467-8659.2011.02032.x" class="external-link">10.1111/j.1467-8659.2011.02032.x</a></p>
<p>B. Schmitzer (2016). A sparse multiscale algorithm for dense optimal transport. J. Math. Imaging Vision 56(2), 238--259. <a href="https://arxiv.org/abs/1510.05466" class="external-link">https://arxiv.org/abs/1510.05466</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Dominic Schuhmacher <a href="mailto:schuhmacher@math.uni-goettingen.de">schuhmacher@math.uni-goettingen.de</a></p>  
<p>Björn Bähre <a href="mailto:bjobae@gmail.com">bjobae@gmail.com</a> (code for <code><a href="aha.html">aha</a></code>-method for <code>p=2</code>)</p>  
<p>Nicolas Bonneel <a href="mailto:nicolas.bonneel@liris.cnrs.fr">nicolas.bonneel@liris.cnrs.fr</a> <br> (adaption of LEMON code for fast <code>networkflow</code> method)</p>  
<p>Carsten Gottschlich <a href="mailto:gottschlich@math.uni-goettingen.de">gottschlich@math.uni-goettingen.de</a> <br> (original java code for <code>shortlist</code> and <code>revsimplex</code> methods)</p>  
<p>Valentin Hartmann <a href="mailto:valentin.hartmann@epfl.ch">valentin.hartmann@epfl.ch</a> (code for <code><a href="semidiscrete1.html">aha</a></code> method for <code>p=1</code>)</p>  
<p>Florian Heinemann <a href="mailto:florian.heinemann@uni-goettingen.de">florian.heinemann@uni-goettingen.de</a> <br> (integration of <code>networkflow</code> method)</p>  
<p>Bernhard Schmitzer <a href="mailto:schmitzer@uni-muenster.de">schmitzer@uni-muenster.de</a> (code for <code><a href="shielding.html">shielding</a></code>-method)</p>
    </div>
    <div class="section level2">
    <h2 id="use-of-cplex">Use of CPLEX<a class="anchor" aria-label="anchor" href="#use-of-cplex"></a></h2>
    <p>The combination of the shielding-method with the CPLEX numerical solver outperforms the other algorithms by an order of magnitude for large problems (only applicable for <code>p=2</code> and objects of class <code>"pgrid"</code>). If a local installation of CPLEX is available, the transport package can be linked against it during installation. See the file src/Makevars in the source package for instructions.</p>
    </div>
    <div class="section level2">
    <h2 id="use-of-cgal">Use of CGAL<a class="anchor" aria-label="anchor" href="#use-of-cgal"></a></h2>
    <p>The combination of the aha-method with <code>p=1</code> requires the use of CGAL (the Computational Geometry Algorithms Library) for dealing with Apollonius diagrams. If you require this functionality, install it from https://www.cgal.org/download.html and adapt the file src/Makevars of this package according to the instructions given in that file. Then re-install 'transport' from source as usual.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="plot.html">plot.pgrid</a></code>,
  <code><a href="wasserstein.html">wasserstein</a></code>,
  <code><a href="unbalanced.html">unbalanced</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># example for the default method</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">80</span>, <span class="fl">150</span>, <span class="fl">50</span>, <span class="fl">140</span>, <span class="fl">170</span>, <span class="fl">30</span>, <span class="fl">10</span>, <span class="fl">70</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">120</span>, <span class="fl">150</span>, <span class="fl">110</span>, <span class="fl">40</span>, <span class="fl">90</span>, <span class="fl">160</span>, <span class="fl">120</span>, <span class="fl">70</span>, <span class="fl">80</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">24</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">costm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">100</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>  </span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">transport</span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span>,<span class="va">costm</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># pretty-print solution in matrix form for very small problems:</span></span></span>
<span class="r-in"><span><span class="va">transp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">transp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">from</span>,<span class="va">res</span><span class="op">$</span><span class="va">to</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">mass</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">transp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">==</span><span class="fl">2</span>,<span class="st">" "</span>,<span class="st">""</span><span class="op">)</span>,<span class="va">a</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">transp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span><span class="op">==</span><span class="fl">2</span>,<span class="st">" "</span>,<span class="st">""</span><span class="op">)</span>,<span class="va">b</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">transp</span><span class="op">)</span>  </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      60 120 150 110  40  90 160 120  70  80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100  30   0   0  70   0   0   0   0   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 200   0   0   0   0   0   0 160   0   0  40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  80   0   0   0  30   0  50   0   0   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 150  30 120   0   0   0   0   0   0   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  50   0   0  50   0   0   0   0   0   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 140   0   0  60   0   0   0   0   0  40  40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 170   0   0   0   0  40  40   0  90   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  30   0   0   0   0   0   0   0   0  30   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  10   0   0   0  10   0   0   0   0   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  70   0   0  40   0   0   0   0  30   0   0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># example for class 'pgrid'</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">9</span>, height<span class="op">=</span><span class="fl">4.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mai<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">random32a</span><span class="op">$</span><span class="va">mass</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">grey</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">200</span><span class="op">/</span><span class="fl">200</span><span class="op">)</span>, axes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">random32b</span><span class="op">$</span><span class="va">mass</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">grey</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">200</span><span class="op">/</span><span class="fl">200</span><span class="op">)</span>, axes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">transport</span><span class="op">(</span><span class="va">random32a</span>,<span class="va">random32b</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Power p of Euclidean distance assumed to be 1 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mai<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">random32a</span>,<span class="va">random32b</span>,<span class="va">res</span>,lwd<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># example for class 'pp'</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">27</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="pp.html">pp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">400</span><span class="op">)</span>,<span class="fl">200</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="pp.html">pp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">400</span><span class="op">)</span>,<span class="fl">200</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">transport</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mai<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.02</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,<span class="va">res</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># example for class 'wpp'</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">30</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">60</span></span></span>
<span class="r-in"><span><span class="va">massx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">massx</span> <span class="op">&lt;-</span> <span class="va">massx</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">massx</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">massy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">massy</span> <span class="op">&lt;-</span> <span class="va">massy</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">massy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="wpp.html">wpp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">m</span><span class="op">)</span>,<span class="va">m</span>,<span class="fl">2</span><span class="op">)</span>,<span class="va">massx</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="wpp.html">wpp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">n</span><span class="op">)</span>,<span class="va">n</span>,<span class="fl">2</span><span class="op">)</span>,<span class="va">massy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">transport</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,method<span class="op">=</span><span class="st">"revsimplex"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,<span class="va">res</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># example for semidiscrete transport between class</span></span></span>
<span class="r-in"><span><span class="co"># 'pgrid' and class 'wpp' (p=2)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">33</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">massb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">massb</span> <span class="op">&lt;-</span> <span class="va">massb</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">massb</span><span class="op">)</span><span class="op">*</span><span class="fl">1e5</span></span></span>
<span class="r-in"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="wpp.html">wpp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">n</span><span class="op">)</span>,<span class="va">n</span>,<span class="fl">2</span><span class="op">)</span>,<span class="va">massb</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">transport</span><span class="op">(</span><span class="va">random32a</span>,<span class="va">b</span>,p<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">random32a</span>,<span class="va">b</span>,<span class="va">res</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># example for semidiscrete transport between class</span></span></span>
<span class="r-in"><span><span class="co"># 'pgrid' and class 'wpp' (p=1)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu">transport</span><span class="fu">:::</span><span class="fu">cgal_present</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">33</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span></span></span>
<span class="r-in"><span>  <span class="va">massb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">massb</span> <span class="op">&lt;-</span> <span class="va">massb</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">massb</span><span class="op">)</span><span class="op">*</span><span class="fl">1e5</span></span></span>
<span class="r-in"><span>  <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="wpp.html">wpp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">n</span><span class="op">)</span>,<span class="va">n</span>,<span class="fl">2</span><span class="op">)</span>,<span class="va">massb</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">transport</span><span class="op">(</span><span class="va">random32a</span>,<span class="va">b</span>,p<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">random32a</span>,<span class="va">b</span>,<span class="va">res</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="copyright">
  <p></p><p>Developed by Dominic Schuhmacher, Björn Bähre, Nicolas Bonneel, Carsten Gottschlich, Valentin Hartmann, Florian Heinemann, Bernhard Schmitzer, Jörn Schrieber.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
  <p class="preferably">Using <a href="https://preferably.amirmasoudabdol.name/?source=footer" class="external-link">preferably</a> template.</p>
</div>

    </footer></div>

  

  

  </body></html>

