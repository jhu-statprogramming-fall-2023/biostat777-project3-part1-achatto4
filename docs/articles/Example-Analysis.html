<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="transport">
<!-- Inform modern browsers that this page supports both dark and light color schemes,
  and the page author prefers light. --><meta name="color-scheme" content="dark light">
<script>
  // If `prefers-color-scheme` is not supported, fall back to light mode.
  // i.e. In this case, inject the `light` CSS before the others, with
  // no media filter so that it will be downloaded with highest priority.
  if (window.matchMedia("(prefers-color-scheme: dark)").media === "not all") {
    document.documentElement.style.display = "none";
    document.head.insertAdjacentHTML(
      "beforeend",
      "<link id=\"css\" rel=\"stylesheet\" href=\"https://bootswatch.com/5/flatly/bootstrap.css\" onload=\"document.documentElement.style.display = ''\">"
    );
  }
</script><title>Example Analysis • transport</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example Analysis">
<meta property="og:description" content="transport">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Flatly Theme - Light  --><link id="css-light" rel="stylesheet" href="https://bootswatch.com/5/flatly/bootstrap.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<!-- Darkly Theme - Dark --><link id="css-dark" rel="stylesheet" href="https://bootswatch.com/5/darkly/bootstrap.css" media="(prefers-color-scheme: dark)">
<!-- preferably CSS --><link rel="stylesheet" href="../preferably.css">
<link id="css-code-light" rel="stylesheet" href="../code-color-scheme-light.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<link id="css-code-dark" rel="stylesheet" href="../code-color-scheme-dark.css" media="(prefers-color-scheme: dark)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">transport</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.14-6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Example-Analysis.html">Example Analysis</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Example Analysis</h1>
            
      
      
      <div class="d-none name"><code>Example-Analysis.Rmd</code></div>
    </div>

    
    
<p>Doctor Who is an extremely long-running British television program.
The show was revived in 2005, and has proven very popular since then.
“Doctor Who” is a British science fiction television series that first
premiered in 1963. The show follows the adventures of the Doctor, a Time
Lord from the planet Gallifrey who travels through time and space in the
TARDIS, a time machine that looks like a British police box. The Doctor,
often accompanied by companions, explores different worlds, encounters a
variety of aliens, and seeks to right wrongs and help those in need. One
of the show’s defining features is the Doctor’s ability to regenerate,
allowing for different actors to take on the role. “Doctor Who” has
become a cultural phenomenon, with a rich history spanning classic and
modern eras, and it continues to captivate audiences with its
imaginative storytelling and iconic characters.To celebrate this year’s
60th anniversary of Doctor Who, the authors of this dataset presented
three datasets.</p>
<p>The data this week comes from Wikipedia’s [List of Doctor Who
episodes](<a href="https://en.wikipedia.org/wiki/List_of_Doctor_Who_episodes_(2005%E2%80%93present)" class="external-link uri">https://en.wikipedia.org/wiki/List_of_Doctor_Who_episodes_(2005%E2%80%93present)</a>
via the {datardis} package by Jonathan Kitt.</p>
<p>In this analysis we try to understand the effect of ‘specials’ on the
ratings of a show(as doctor who has many special episodes). We also
analyse the changes in durations of the show over time, its effect on
the ratings. We further compartmentalize the results to get a better
idea of the underlying phenomenon.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dschuhm1.pages.gwdg.de/software" class="external-link">transport</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/thebioengineer/tidytuesdayR" class="external-link">tidytuesdayR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#install.packages("tidytuesdayR")</span></span>
<span></span>
<span> <span class="co">#tuesdata &lt;- tidytuesdayR::tt_load('2023-11-28')</span></span>
<span> <span class="co"># ## OR</span></span>
<span> <span class="co">#tuesdata &lt;- tidytuesdayR::tt_load(2023, week = 39)</span></span>
<span></span>
<span><span class="co">#  drwho_episodes &lt;- tuesdata$drwho_episodes</span></span>
<span><span class="co"># drwho_directors &lt;- tuesdata$drwho_directors</span></span>
<span><span class="co"># drwho_writers &lt;- tuesdata$drwho_writers</span></span>
<span></span>
<span>     <span class="co"># dir.create("data")</span></span>
<span>     <span class="co">#</span></span>
<span>     <span class="co"># saveRDS(richmondway, file = "data/richmondway.RDS")</span></span>
<span></span>
<span>    <span class="co">#my_data &lt;- readRDS("~Anaghpackage/data/richmondway.RDS")</span></span>
<span></span>
<span> <span class="va">drwho_episodes</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-11-28/drwho_episodes.csv'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">175</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">12</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">--</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">--------------------------------------------------------</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span>  (6): era, serial_title, story_number, episode_title, type, production_code</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span>  (5): season_number, episode_number, uk_viewers, rating, duration</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">date</span> (1): first_aired</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">i</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">i</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span> <span class="va">drwho_directors</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-11-28/drwho_directors.csv'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">175</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">--</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">--------------------------------------------------------</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span> (2): story_number, director</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">i</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">i</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span> <span class="va">drwho_writers</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-11-28/drwho_writers.csv'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">186</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">--</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">--------------------------------------------------------</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span> (2): story_number, writer</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">i</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">i</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span></span>
<span><span class="co">#</span></span>
<span>    <span class="va">my_data1</span><span class="op">=</span> <span class="va">drwho_episodes</span></span>
<span>    <span class="va">my_data2</span><span class="op">=</span> <span class="va">drwho_directors</span></span>
<span>    <span class="va">my_data3</span><span class="op">=</span> <span class="va">drwho_writers</span></span></code></pre></div>
<p>We save the data below-</p>
<p>The data directory is created in Vignettes.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">create_data_directory</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Data directory already exists.</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="st">"data/my_data3.csv"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">save_data</span><span class="op">(</span><span class="va">my_data3</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">my_data3</span> <span class="op">&lt;-</span> <span class="fu">read_data</span><span class="op">(</span><span class="va">my_data3</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Data read from data/my_data3.csv</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="st">"data/my_data2.csv"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">save_data</span><span class="op">(</span><span class="va">my_data2</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">my_data2</span> <span class="op">&lt;-</span> <span class="fu">read_data</span><span class="op">(</span><span class="va">my_data2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Data read from data/my_data2.csv</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="st">"data/my_data1.csv"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">save_data</span><span class="op">(</span><span class="va">my_data1</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">my_data1</span> <span class="op">&lt;-</span> <span class="fu">read_data</span><span class="op">(</span><span class="va">my_data1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Data read from data/my_data1.csv</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#read the dataset</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org/" class="external-link">forcats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We summarise the data and get a glimpse of the data set using the two functions below respectively.</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="va">my_data1</span><span class="op">)</span></span>
<span><span class="co">#&gt; data frame with 0 columns and 1 row</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">my_data1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 175</span></span>
<span><span class="co">#&gt; Columns: 12</span></span>
<span><span class="co">#&gt; $ era             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "revived", "revived", "revived", "revived", "revived",~</span></span>
<span><span class="co">#&gt; $ season_number   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, ~</span></span>
<span><span class="co">#&gt; $ serial_title    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA~</span></span>
<span><span class="co">#&gt; $ story_number    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "157", "158", "159", "160a", "160b", "161", "162", "16~</span></span>
<span><span class="co">#&gt; $ episode_number  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, NA, 1, 2, 3~</span></span>
<span><span class="co">#&gt; $ episode_title   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Rose", "The End of the World", "The Unquiet Dead", "A~</span></span>
<span><span class="co">#&gt; $ type            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "episode", "episode", "episode", "episode", "episode",~</span></span>
<span><span class="co">#&gt; $ first_aired     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "2005-03-26", "2005-04-02", "2005-04-09", "2005-04-16"~</span></span>
<span><span class="co">#&gt; $ production_code <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1.1", "1.2", "1.3", "1.4", "1.5", "1.6", "1.7", "1.8"~</span></span>
<span><span class="co">#&gt; $ uk_viewers      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 10.81, 7.97, 8.86, 7.63, 7.98, 8.63, 8.01, 8.06, 7.11,~</span></span>
<span><span class="co">#&gt; $ rating          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 76, 76, 80, 82, 81, 84, 81, 83, 84, 85, 82, 86, 89, 84~</span></span>
<span><span class="co">#&gt; $ duration        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 45, 44, 44, 45, 42, 45, 44, 45, 45, 45, 45, 45, 45, 60~</span></span>
<span></span>
<span><span class="co">#This functions counts the numbers of unique value corresponding to the dataset, and it helps us understand the presence of any repetitions.</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">my_data1</span><span class="op">)</span></span>
<span><span class="co">#&gt;     n</span></span>
<span><span class="co">#&gt; 1 175</span></span>
<span></span>
<span><span class="co">#We use the distinct function to find distinct value in the data, and convert the data structure to tibble for better operationality.</span></span>
<span><span class="va">my_data_new1</span><span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">my_data1</span><span class="op">)</span></span>
<span><span class="va">my_data_new1</span><span class="op">=</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">my_data_new1</span><span class="op">)</span></span>
<span><span class="va">my_data_new1</span><span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">my_data_new1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We summarise the data and get a glimpse of the data set using the two functions below respectively.</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="va">my_data2</span><span class="op">)</span></span>
<span><span class="co">#&gt; data frame with 0 columns and 1 row</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">my_data2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 175</span></span>
<span><span class="co">#&gt; Columns: 2</span></span>
<span><span class="co">#&gt; $ story_number <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "157", "158", "159", "160a", "160b", "161", "162", "163",~</span></span>
<span><span class="co">#&gt; $ director     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Keith Boak", "Euros Lyn", "Euros Lyn", "Keith Boak", "Ke~</span></span>
<span></span>
<span><span class="co">#This functions counts the numbers of unique value corresponding to the dataset, and it helps us understand the presence of any repetitions.</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">my_data2</span><span class="op">)</span></span>
<span><span class="co">#&gt;     n</span></span>
<span><span class="co">#&gt; 1 175</span></span>
<span></span>
<span><span class="co">#We use the distinct function to find distinct value in the data, and convert the data structure to tibble for better operationality.</span></span>
<span><span class="va">my_data_new2</span><span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">my_data2</span><span class="op">)</span></span>
<span><span class="va">my_data_new2</span><span class="op">=</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">my_data_new2</span><span class="op">)</span></span>
<span><span class="va">my_data_new2</span><span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">my_data_new2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We summarise the data and get a glimpse of the data set using the two functions below respectively.</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="va">my_data3</span><span class="op">)</span></span>
<span><span class="co">#&gt; data frame with 0 columns and 1 row</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">my_data3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 186</span></span>
<span><span class="co">#&gt; Columns: 2</span></span>
<span><span class="co">#&gt; $ story_number <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "157", "158", "159", "160a", "160b", "161", "162", "163",~</span></span>
<span><span class="co">#&gt; $ writer       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Russell T Davies", "Russell T Davies", "Mark Gatiss", "R~</span></span>
<span></span>
<span><span class="co">#This functions counts the numbers of unique value corresponding to the dataset, and it helps us understand the presence of any repetitions.</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">my_data3</span><span class="op">)</span></span>
<span><span class="co">#&gt;     n</span></span>
<span><span class="co">#&gt; 1 186</span></span>
<span></span>
<span><span class="co">#We use the distinct function to find distinct value in the data, and convert the data structure to tibble for better operationality.</span></span>
<span><span class="va">my_data_new3</span><span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">my_data3</span><span class="op">)</span></span>
<span><span class="va">my_data_new3</span><span class="op">=</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">my_data_new3</span><span class="op">)</span></span>
<span><span class="va">my_data_new3</span><span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">my_data_new3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#We also find the current time to be able to understand the date till which the analysis is valid. The analysis might not be valid at a future date.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/timezones.html" class="external-link">Sys.timezone</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "America/New_York"</span></span>
<span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html" class="external-link">now</a></span><span class="op">(</span>tzone <span class="op">=</span> <span class="st">"America/New_York"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "2023-12-11 22:16:55 EST"</span></span></code></pre></div>
<p>We now use Purr to simultaneously apply functions to vectors.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="va">vec_req</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">my_data_new1</span><span class="op">$</span><span class="va">rating</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">vec_req</span>, <span class="op">~</span><span class="op">(</span><span class="va">.</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">vec_req</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">vec_req</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">vec_req</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#We scale the ratings to 0,1</span></span>
<span><span class="va">result</span></span>
<span><span class="co">#&gt;   [1] 0.0625 0.0625 0.3125 0.4375 0.3750 0.5625 0.3750 0.5000 0.5625 0.6250</span></span>
<span><span class="co">#&gt;  [11] 0.4375 0.6875 0.8750 0.5625 0.6250 0.5000 0.6250 0.5625 0.6875 0.6875</span></span>
<span><span class="co">#&gt;  [21] 0.5625 0.6250 0.6875 0.0625 0.5000 0.6875 0.8750 0.5625 0.8125 0.7500</span></span>
<span><span class="co">#&gt;  [31] 0.6250 0.6875 0.6250 0.6875 0.6250 0.6875 0.6875 0.7500 0.7500 0.7500</span></span>
<span><span class="co">#&gt;  [41] 0.8125 0.6875 0.8125 0.7500 0.7500 0.7500 0.8125 0.8125 0.6875 0.8750</span></span>
<span><span class="co">#&gt;  [51] 0.8750 0.6875 0.8125 1.0000 1.0000 0.6875 0.8125 0.8125 0.7500 0.8750</span></span>
<span><span class="co">#&gt;  [61] 0.6875 0.6875 0.5625 0.7500 0.6875 0.6875 0.5625 0.6875 0.6250 0.6875</span></span>
<span><span class="co">#&gt;  [71] 0.7500 0.8125 0.8750 0.5000 0.8125 0.7500 0.6875 0.7500 0.6250 0.6875</span></span>
<span><span class="co">#&gt;  [81] 0.8125 0.6250 0.6875 0.6250 0.6875 0.6875 0.6875 0.5625 0.8750 0.7500</span></span>
<span><span class="co">#&gt;  [91] 0.6250 0.7500 0.8125 0.7500 0.7500 0.5625 0.5625 0.6250 0.6250 0.6250</span></span>
<span><span class="co">#&gt; [101] 0.5625 0.8125 0.8125 0.5000 0.4375 0.5625 0.4375 0.4375 0.5625 0.5000</span></span>
<span><span class="co">#&gt; [111] 0.4375 0.6250 0.6250 0.5000 0.6250 0.5000 0.4375 0.5625 0.5000 0.5625</span></span>
<span><span class="co">#&gt; [121] 0.5000 0.4375 0.3750 0.4375 0.5625 0.1875 0.5625 0.3125 0.4375 0.4375</span></span>
<span><span class="co">#&gt; [131] 0.4375 0.5000 0.5000 0.5625 0.5000 0.5000 0.4375 0.4375 0.4375 0.5000</span></span>
<span><span class="co">#&gt; [141] 0.3750 0.6250 0.5000 0.3750 0.5000 0.4375 0.5000 0.5000 0.2500 0.3125</span></span>
<span><span class="co">#&gt; [151] 0.3750 0.3750 0.3125 0.2500 0.3125 0.4375 0.4375 0.1250 0.2500 0.5000</span></span>
<span><span class="co">#&gt; [161] 0.1875 0.1875 0.3125 0.3750 0.4375 0.2500 0.0625 0.1250 0.0000 0.2500</span></span>
<span><span class="co">#&gt; [171] 0.1250 0.0625 0.1250 0.0625 0.4375</span></span>
<span></span>
<span><span class="co">#We convert all the uppercase names of the directors to lower case.</span></span>
<span><span class="va">lowercase_words</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_chr</a></span><span class="op">(</span><span class="va">my_data_new2</span><span class="op">$</span><span class="va">director</span>, <span class="va">tolower</span><span class="op">)</span></span>
<span><span class="va">lowercase_words</span></span>
<span><span class="co">#&gt;   [1] "keith boak"         "euros lyn"          "euros lyn"         </span></span>
<span><span class="co">#&gt;   [4] "keith boak"         "keith boak"         "joe ahearne"       </span></span>
<span><span class="co">#&gt;   [7] "brian grant"        "joe ahearne"        "james hawes"       </span></span>
<span><span class="co">#&gt;  [10] "james hawes"        "joe ahearne"        "joe ahearne"       </span></span>
<span><span class="co">#&gt;  [13] "joe ahearne"        "james hawes"        "james hawes"       </span></span>
<span><span class="co">#&gt;  [16] "euros lyn"          "james hawes"        "euros lyn"         </span></span>
<span><span class="co">#&gt;  [19] "graeme harper"      "graeme harper"      "euros lyn"         </span></span>
<span><span class="co">#&gt;  [22] "james strong"       "james strong"       "dan zeff"          </span></span>
<span><span class="co">#&gt;  [25] "euros lyn"          "graeme harper"      "graeme harper"     </span></span>
<span><span class="co">#&gt;  [28] "euros lyn"          "charles palmer"     "charles palmer"    </span></span>
<span><span class="co">#&gt;  [31] "richard clark"      "james strong"       "james strong"      </span></span>
<span><span class="co">#&gt;  [34] "richard clark"      "graeme harper"      "charles palmer"    </span></span>
<span><span class="co">#&gt;  [37] "charles palmer"     "hettie macdonald"   "graeme harper"     </span></span>
<span><span class="co">#&gt;  [40] "colin teague"       "colin teague"       "james strong"      </span></span>
<span><span class="co">#&gt;  [43] "james strong"       "colin teague"       "graeme harper"     </span></span>
<span><span class="co">#&gt;  [46] "douglas mackinnon"  "douglas mackinnon"  "alice troughton"   </span></span>
<span><span class="co">#&gt;  [49] "graeme harper"      "euros lyn"          "euros lyn"         </span></span>
<span><span class="co">#&gt;  [52] "alice troughton"    "graeme harper"      "graeme harper"     </span></span>
<span><span class="co">#&gt;  [55] "graeme harper"      "andy goddard"       "james strong"      </span></span>
<span><span class="co">#&gt;  [58] "graeme harper"      "euros lyn"          "euros lyn"         </span></span>
<span><span class="co">#&gt;  [61] "adam smith"         "andrew gunn"        "andrew gunn"       </span></span>
<span><span class="co">#&gt;  [64] "adam smith"         "adam smith"         "jonny campbell"    </span></span>
<span><span class="co">#&gt;  [67] "catherine morshead" "ashley way"         "ashley way"        </span></span>
<span><span class="co">#&gt;  [70] "jonny campbell"     "catherine morshead" "toby haynes"       </span></span>
<span><span class="co">#&gt;  [73] "toby haynes"        "toby haynes"        "toby haynes"       </span></span>
<span><span class="co">#&gt;  [76] "toby haynes"        "jeremy webb"        "richard clark"     </span></span>
<span><span class="co">#&gt;  [79] "julian simpson"     "julian simpson"     "peter hoar"        </span></span>
<span><span class="co">#&gt;  [82] "richard senior"     "richard clark"      "nick hurran"       </span></span>
<span><span class="co">#&gt;  [85] "nick hurran"        "steve hughes"       "jeremy webb"       </span></span>
<span><span class="co">#&gt;  [88] "farren blackburn"   "nick hurran"        "saul metzstein"    </span></span>
<span><span class="co">#&gt;  [91] "saul metzstein"     "douglas mackinnon"  "nick hurran"       </span></span>
<span><span class="co">#&gt;  [94] "saul metzstein"     "colm mccarthy"      "farren blackburn"  </span></span>
<span><span class="co">#&gt;  [97] "douglas mackinnon"  "jamie payne"        "mat king"          </span></span>
<span><span class="co">#&gt; [100] "saul metzstein"     "stephen woolfenden" "saul metzstein"    </span></span>
<span><span class="co">#&gt; [103] "nick hurran"        "jamie payne"        "ben wheatley"      </span></span>
<span><span class="co">#&gt; [106] "ben wheatley"       "paul murphy"        "douglas mackinnon" </span></span>
<span><span class="co">#&gt; [109] "douglas mackinnon"  "paul murphy"        "paul wilmshurst"   </span></span>
<span><span class="co">#&gt; [112] "paul wilmshurst"    "douglas mackinnon"  "sheree folkson"    </span></span>
<span><span class="co">#&gt; [115] "rachel talalay"     "rachel talalay"     "paul wilmshurst"   </span></span>
<span><span class="co">#&gt; [118] "hettie macdonald"   "hettie macdonald"   "daniel o'hara"     </span></span>
<span><span class="co">#&gt; [121] "daniel o'hara"      "ed bazalgette"      "ed bazalgette"     </span></span>
<span><span class="co">#&gt; [124] "daniel nettheim"    "daniel nettheim"    "justin molotnikov" </span></span>
<span><span class="co">#&gt; [127] "justin molotnikov"  "rachel talalay"     "rachel talalay"    </span></span>
<span><span class="co">#&gt; [130] "douglas mackinnon"  "ed bazalgette"      "lawrence gough"    </span></span>
<span><span class="co">#&gt; [133] "lawrence gough"     "bill anderson"      "bill anderson"     </span></span>
<span><span class="co">#&gt; [136] "charles palmer"     "daniel nettheim"    "daniel nettheim"   </span></span>
<span><span class="co">#&gt; [139] "wayne yip"          "wayne yip"          "charles palmer"    </span></span>
<span><span class="co">#&gt; [142] "rachel talalay"     "rachel talalay"     "rachel talalay"    </span></span>
<span><span class="co">#&gt; [145] "jamie childs"       "mark tonderai"      "mark tonderai"     </span></span>
<span><span class="co">#&gt; [148] "sallie aprahamian"  "jennifer perrott"   "jamie childs"      </span></span>
<span><span class="co">#&gt; [151] "jennifer perrott"   "sallie aprahamian"  "jamie childs"      </span></span>
<span><span class="co">#&gt; [154] "jamie childs"       "wayne yip"          "jamie magnus stone"</span></span>
<span><span class="co">#&gt; [157] "lee haven jones"    "lee haven jones"    "nida manzoor"      </span></span>
<span><span class="co">#&gt; [160] "nida manzoor"       "jamie magnus stone" "emma sullivan"     </span></span>
<span><span class="co">#&gt; [163] "emma sullivan"      "jamie magnus stone" "jamie magnus stone"</span></span>
<span><span class="co">#&gt; [166] "lee haven jones"    "jamie magnus stone" "jamie magnus stone"</span></span>
<span><span class="co">#&gt; [169] "azhur saleem"       "jamie magnus stone" "azhur saleem"      </span></span>
<span><span class="co">#&gt; [172] "azhur saleem"       "annetta laufer"     "haolu wang"        </span></span>
<span><span class="co">#&gt; [175] "jamie magnus stone"</span></span></code></pre></div>
<p>The scaling gives us novel insights about the distribution of the
ratings and we see that the ratings are fairly homogeneous.</p>
<p>We now apply the Optimal Transport maps to find the distance between
the ratings in regular and special episodes.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dschuhm1.pages.gwdg.de/software" class="external-link">transport</a></span><span class="op">)</span></span>
<span><span class="va">datarate1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">(</span><span class="va">my_data_new1</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">my_data_new1</span><span class="op">$</span><span class="va">type</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">my_data_new1</span><span class="op">$</span><span class="va">type</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">rating</span><span class="op">)</span></span>
<span><span class="va">datarate2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">(</span><span class="va">my_data_new1</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">my_data_new1</span><span class="op">$</span><span class="va">type</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">my_data_new1</span><span class="op">$</span><span class="va">type</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">rating</span><span class="op">)</span></span>
<span></span>
<span><span class="va">num_1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">datarate1</span><span class="op">)</span></span>
<span><span class="va">num_2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">datarate2</span><span class="op">)</span></span>
<span><span class="va">numc</span><span class="op">=</span><span class="va">num_1</span><span class="op">*</span><span class="va">num_2</span></span>
<span><span class="va">nums</span><span class="op">=</span><span class="va">num_1</span><span class="op">+</span><span class="va">num_2</span></span>
<span></span>
<span><span class="va">ground_p</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">w1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">num_1</span>, <span class="va">num_1</span><span class="op">)</span></span>
<span><span class="va">w2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">num_2</span>, <span class="va">num_2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cost_matrix_Lp</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,<span class="va">ground_p</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">mat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">mat</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span><span class="op">&lt;-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">-</span> <span class="va">y</span><span class="op">[</span><span class="va">j</span>,<span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="va">ground_p</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">ground_p</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">costm1</span><span class="op">=</span><span class="fu">cost_matrix_Lp</span><span class="op">(</span><span class="va">datarate1</span>, <span class="va">datarate2</span>, ground_p<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#The transport map is found below</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transport.html">transport</a></span><span class="op">(</span><span class="va">w1</span>, <span class="va">w2</span>, costm<span class="op">=</span><span class="va">costm1</span><span class="op">)</span></span>
<span><span class="va">res</span></span>
<span><span class="co">#&gt;     from to         mass</span></span>
<span><span class="co">#&gt; 1      1 21 0.0065359477</span></span>
<span><span class="co">#&gt; 2      2 21 0.0065359477</span></span>
<span><span class="co">#&gt; 3      3 18 0.0065359477</span></span>
<span><span class="co">#&gt; 4      4 14 0.0065359477</span></span>
<span><span class="co">#&gt; 5      5 17 0.0065359477</span></span>
<span><span class="co">#&gt; 6      6 22 0.0065359477</span></span>
<span><span class="co">#&gt; 7      7 17 0.0065359477</span></span>
<span><span class="co">#&gt; 8      8  9 0.0065359477</span></span>
<span><span class="co">#&gt; 9      9  1 0.0065359477</span></span>
<span><span class="co">#&gt; 10    10 22 0.0065359477</span></span>
<span><span class="co">#&gt; 11    11 14 0.0065359477</span></span>
<span><span class="co">#&gt; 12    12  3 0.0065359477</span></span>
<span><span class="co">#&gt; 13    13  5 0.0065359477</span></span>
<span><span class="co">#&gt; 14    14 10 0.0065359477</span></span>
<span><span class="co">#&gt; 15    15 15 0.0065359477</span></span>
<span><span class="co">#&gt; 16    16 14 0.0041592395</span></span>
<span><span class="co">#&gt; 17    16 19 0.0023767083</span></span>
<span><span class="co">#&gt; 18    17  2 0.0065359477</span></span>
<span><span class="co">#&gt; 19    18 12 0.0065359477</span></span>
<span><span class="co">#&gt; 20    19  7 0.0065359477</span></span>
<span><span class="co">#&gt; 21    20 16 0.0065359477</span></span>
<span><span class="co">#&gt; 22    21 10 0.0065359477</span></span>
<span><span class="co">#&gt; 23    22  7 0.0065359477</span></span>
<span><span class="co">#&gt; 24    23 21 0.0065359477</span></span>
<span><span class="co">#&gt; 25    24  9 0.0065359477</span></span>
<span><span class="co">#&gt; 26    25  6 0.0065359477</span></span>
<span><span class="co">#&gt; 27    26  8 0.0065359477</span></span>
<span><span class="co">#&gt; 28    27  5 0.0047534165</span></span>
<span><span class="co">#&gt; 29    27  6 0.0017825312</span></span>
<span><span class="co">#&gt; 30    28  6 0.0065359477</span></span>
<span><span class="co">#&gt; 31    29 22 0.0065359477</span></span>
<span><span class="co">#&gt; 32    30  3 0.0065359477</span></span>
<span><span class="co">#&gt; 33    31 16 0.0065359477</span></span>
<span><span class="co">#&gt; 34    32  4 0.0065359477</span></span>
<span><span class="co">#&gt; 35    33  2 0.0026737968</span></span>
<span><span class="co">#&gt; 36    33 19 0.0038621509</span></span>
<span><span class="co">#&gt; 37    34  5 0.0065359477</span></span>
<span><span class="co">#&gt; 38    35  3 0.0065359477</span></span>
<span><span class="co">#&gt; 39    36  5 0.0065359477</span></span>
<span><span class="co">#&gt; 40    37  5 0.0065359477</span></span>
<span><span class="co">#&gt; 41    38  7 0.0065359477</span></span>
<span><span class="co">#&gt; 42    39  6 0.0065359477</span></span>
<span><span class="co">#&gt; 43    40  6 0.0065359477</span></span>
<span><span class="co">#&gt; 44    41  7 0.0065359477</span></span>
<span><span class="co">#&gt; 45    42  5 0.0065359477</span></span>
<span><span class="co">#&gt; 46    43  7 0.0065359477</span></span>
<span><span class="co">#&gt; 47    44 12 0.0065359477</span></span>
<span><span class="co">#&gt; 48    45  5 0.0065359477</span></span>
<span><span class="co">#&gt; 49    46  7 0.0065359477</span></span>
<span><span class="co">#&gt; 50    47  8 0.0065359477</span></span>
<span><span class="co">#&gt; 51    48  8 0.0065359477</span></span>
<span><span class="co">#&gt; 52    49 12 0.0065359477</span></span>
<span><span class="co">#&gt; 53    50 12 0.0065359477</span></span>
<span><span class="co">#&gt; 54    51  8 0.0065359477</span></span>
<span><span class="co">#&gt; 55    52  8 0.0065359477</span></span>
<span><span class="co">#&gt; 56    53  4 0.0065359477</span></span>
<span><span class="co">#&gt; 57    54  3 0.0065359477</span></span>
<span><span class="co">#&gt; 58    55 15 0.0065359477</span></span>
<span><span class="co">#&gt; 59    56 11 0.0065359477</span></span>
<span><span class="co">#&gt; 60    57  1 0.0023767083</span></span>
<span><span class="co">#&gt; 61    57 12 0.0041592395</span></span>
<span><span class="co">#&gt; 62    58 11 0.0065359477</span></span>
<span><span class="co">#&gt; 63    59 15 0.0065359477</span></span>
<span><span class="co">#&gt; 64    60  4 0.0059417706</span></span>
<span><span class="co">#&gt; 65    60  5 0.0005941771</span></span>
<span><span class="co">#&gt; 66    61  1 0.0065359477</span></span>
<span><span class="co">#&gt; 67    62  4 0.0065359477</span></span>
<span><span class="co">#&gt; 68    63 11 0.0065359477</span></span>
<span><span class="co">#&gt; 69    64  6 0.0065359477</span></span>
<span><span class="co">#&gt; 70    65  5 0.0002970885</span></span>
<span><span class="co">#&gt; 71    65  8 0.0062388592</span></span>
<span><span class="co">#&gt; 72    66 12 0.0065359477</span></span>
<span><span class="co">#&gt; 73    67  7 0.0002970885</span></span>
<span><span class="co">#&gt; 74    67 11 0.0062388592</span></span>
<span><span class="co">#&gt; 75    68  4 0.0065359477</span></span>
<span><span class="co">#&gt; 76    69 11 0.0065359477</span></span>
<span><span class="co">#&gt; 77    70  1 0.0065359477</span></span>
<span><span class="co">#&gt; 78    71  3 0.0065359477</span></span>
<span><span class="co">#&gt; 79    72 12 0.0065359477</span></span>
<span><span class="co">#&gt; 80    73  2 0.0035650624</span></span>
<span><span class="co">#&gt; 81    73  9 0.0029708853</span></span>
<span><span class="co">#&gt; 82    74  4 0.0065359477</span></span>
<span><span class="co">#&gt; 83    75  2 0.0065359477</span></span>
<span><span class="co">#&gt; 84    76  4 0.0065359477</span></span>
<span><span class="co">#&gt; 85    77  3 0.0065359477</span></span>
<span><span class="co">#&gt; 86    78  3 0.0062388592</span></span>
<span><span class="co">#&gt; 87    78  4 0.0002970885</span></span>
<span><span class="co">#&gt; 88    79  8 0.0065359477</span></span>
<span><span class="co">#&gt; 89    80 11 0.0065359477</span></span>
<span><span class="co">#&gt; 90    81  9 0.0002970885</span></span>
<span><span class="co">#&gt; 91    81 10 0.0062388592</span></span>
<span><span class="co">#&gt; 92    82 11 0.0065359477</span></span>
<span><span class="co">#&gt; 93    83  6 0.0065359477</span></span>
<span><span class="co">#&gt; 94    84  5 0.0005941771</span></span>
<span><span class="co">#&gt; 95    84  7 0.0059417706</span></span>
<span><span class="co">#&gt; 96    85  1 0.0065359477</span></span>
<span><span class="co">#&gt; 97    86  1 0.0065359477</span></span>
<span><span class="co">#&gt; 98    87 20 0.0002970885</span></span>
<span><span class="co">#&gt; 99    87 21 0.0062388592</span></span>
<span><span class="co">#&gt; 100   88 15 0.0059417706</span></span>
<span><span class="co">#&gt; 101   88 20 0.0005941771</span></span>
<span><span class="co">#&gt; 102   89  2 0.0065359477</span></span>
<span><span class="co">#&gt; 103   90  2 0.0065359477</span></span>
<span><span class="co">#&gt; 104   91  6 0.0044563280</span></span>
<span><span class="co">#&gt; 105   91 12 0.0020796197</span></span>
<span><span class="co">#&gt; 106   92 15 0.0065359477</span></span>
<span><span class="co">#&gt; 107   93  2 0.0065359477</span></span>
<span><span class="co">#&gt; 108   94 14 0.0065359477</span></span>
<span><span class="co">#&gt; 109   95 16 0.0065359477</span></span>
<span><span class="co">#&gt; 110   96 10 0.0065359477</span></span>
<span><span class="co">#&gt; 111   97 19 0.0065359477</span></span>
<span><span class="co">#&gt; 112   98 14 0.0065359477</span></span>
<span><span class="co">#&gt; 113   99 13 0.0065359477</span></span>
<span><span class="co">#&gt; 114  100  1 0.0065359477</span></span>
<span><span class="co">#&gt; 115  101  9 0.0065359477</span></span>
<span><span class="co">#&gt; 116  102 18 0.0065359477</span></span>
<span><span class="co">#&gt; 117  103 20 0.0002970885</span></span>
<span><span class="co">#&gt; 118  103 22 0.0062388592</span></span>
<span><span class="co">#&gt; 119  104 14 0.0065359477</span></span>
<span><span class="co">#&gt; 120  105  9 0.0029708853</span></span>
<span><span class="co">#&gt; 121  105 16 0.0035650624</span></span>
<span><span class="co">#&gt; 122  106 10 0.0065359477</span></span>
<span><span class="co">#&gt; 123  107  9 0.0065359477</span></span>
<span><span class="co">#&gt; 124  108 16 0.0065359477</span></span>
<span><span class="co">#&gt; 125  109 17 0.0065359477</span></span>
<span><span class="co">#&gt; 126  110 16 0.0065359477</span></span>
<span><span class="co">#&gt; 127  111 10 0.0065359477</span></span>
<span><span class="co">#&gt; 128  112 20 0.0065359477</span></span>
<span><span class="co">#&gt; 129  113  2 0.0065359477</span></span>
<span><span class="co">#&gt; 130  114 18 0.0065359477</span></span>
<span><span class="co">#&gt; 131  115 18 0.0065359477</span></span>
<span><span class="co">#&gt; 132  116  9 0.0065359477</span></span>
<span><span class="co">#&gt; 133  117 22 0.0065359477</span></span>
<span><span class="co">#&gt; 134  118  1 0.0038621509</span></span>
<span><span class="co">#&gt; 135  118 16 0.0026737968</span></span>
<span><span class="co">#&gt; 136  119 13 0.0065359477</span></span>
<span><span class="co">#&gt; 137  120  9 0.0065359477</span></span>
<span><span class="co">#&gt; 138  121 19 0.0065359477</span></span>
<span><span class="co">#&gt; 139  122 22 0.0065359477</span></span>
<span><span class="co">#&gt; 140  123 15 0.0065359477</span></span>
<span><span class="co">#&gt; 141  124 13 0.0062388592</span></span>
<span><span class="co">#&gt; 142  124 15 0.0002970885</span></span>
<span><span class="co">#&gt; 143  125 17 0.0062388592</span></span>
<span><span class="co">#&gt; 144  125 20 0.0002970885</span></span>
<span><span class="co">#&gt; 145  126 10 0.0065359477</span></span>
<span><span class="co">#&gt; 146  127 13 0.0065359477</span></span>
<span><span class="co">#&gt; 147  128 13 0.0065359477</span></span>
<span><span class="co">#&gt; 148  129 16 0.0065359477</span></span>
<span><span class="co">#&gt; 149  130 13 0.0065359477</span></span>
<span><span class="co">#&gt; 150  131 13 0.0065359477</span></span>
<span><span class="co">#&gt; 151  132 19 0.0065359477</span></span>
<span><span class="co">#&gt; 152  133 18 0.0065359477</span></span>
<span><span class="co">#&gt; 153  134 17 0.0065359477</span></span>
<span><span class="co">#&gt; 154  135 17 0.0065359477</span></span>
<span><span class="co">#&gt; 155  136 18 0.0062388592</span></span>
<span><span class="co">#&gt; 156  136 20 0.0002970885</span></span>
<span><span class="co">#&gt; 157  137 19 0.0065359477</span></span>
<span><span class="co">#&gt; 158  138 14 0.0020796197</span></span>
<span><span class="co">#&gt; 159  138 20 0.0044563280</span></span>
<span><span class="co">#&gt; 160  139 14 0.0065359477</span></span>
<span><span class="co">#&gt; 161  140 20 0.0065359477</span></span>
<span><span class="co">#&gt; 162  141 19 0.0065359477</span></span>
<span><span class="co">#&gt; 163  142 15 0.0065359477</span></span>
<span><span class="co">#&gt; 164  143 20 0.0065359477</span></span>
<span><span class="co">#&gt; 165  144 20 0.0065359477</span></span>
<span><span class="co">#&gt; 166  145 18 0.0065359477</span></span>
<span><span class="co">#&gt; 167  146 17 0.0065359477</span></span>
<span><span class="co">#&gt; 168  147 22 0.0065359477</span></span>
<span><span class="co">#&gt; 169  148 21 0.0065359477</span></span>
<span><span class="co">#&gt; 170  149 20 0.0065359477</span></span>
<span><span class="co">#&gt; 171  150 21 0.0065359477</span></span>
<span><span class="co">#&gt; 172  151 19 0.0065359477</span></span>
<span><span class="co">#&gt; 173  152 20 0.0065359477</span></span>
<span><span class="co">#&gt; 174  153 21 0.0065359477</span></span>
<span></span>
<span><span class="co">#The wasserstein distance is found below</span></span>
<span><span class="fu"><a href="../reference/wasserstein.html">wasserstein</a></span><span class="op">(</span>a<span class="op">=</span><span class="va">w1</span>, b<span class="op">=</span><span class="va">w2</span>, costm<span class="op">=</span><span class="fu">cost_matrix_Lp</span><span class="op">(</span><span class="va">datarate1</span>,<span class="va">datarate2</span>,ground_p<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.6708259</span></span></code></pre></div>
<p>The transport map and low wasserstein distance shows that the two
rating distributions are not far from each other.</p>
<p>We firstly look at the progression of seasons/episodes and correlate
it with the duration of the episodes. We can see that there has been an
increase as the seasons progressed. However most of the episodes are 45
minutes long.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">my_data_new1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">production_code</span>, y <span class="op">=</span> <span class="va">duration</span>, group<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Season-Episode vs Duration"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"For Doctor Who"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Data source: Tidytuesday"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Example-Analysis_files/figure-html/plot%201-1.png" width="100%"></p>
<p>We also looked at the relationship between the progression of seasons
with the ratings of the episode. There is a tendency of episodes to have
a similar ratings, but there are periods irrespective of type of
episodes, where the ratings have fluctuated a lot.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">my_data_new1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">production_code</span>, y <span class="op">=</span> <span class="va">rating</span>, group<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">type</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Season-Episode vs Rating"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"For Doctor Who"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Data source: Tidytuesday"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Example-Analysis_files/figure-html/plot%202-1.png" width="100%"></p>
<p>Finally we look at the effect of type of season on the ratings. It
seems that there is not much effect of type of episodes.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">my_data_new1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">type</span>, y <span class="op">=</span> <span class="va">rating</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Episode Type vs Rating"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"For Doctor Who"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Data source: Tidytuesday"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Example-Analysis_files/figure-html/plot%203-1.png" width="100%"></p>
<p>In this analysis, we sought to comprehensively examine the impact of
‘specials’ on the ratings of a show, taking into consideration the
numerous special episodes featured, particularly evident in series such
as Doctor Who. Additionally, we delved into the variations in the show’s
duration over time, exploring how these changes influenced audience
ratings. To enhance our understanding of the underlying phenomenon, we
further segmented the results, providing a nuanced and detailed
perspective on the observed patterns.</p>
<p>Packages used- summarise, glimpse, count, distinct, as_tibble,
arrange, Sys.timezone now</p>
<p>Purrr- map_dbl, map_chr</p>
<p>Transport- transport, Wasserstein</p>
<p>Geom- point, line, boxplot</p>
<p>facet_wrap</p>
  </main>
</div>



    <footer><div class="copyright">
  <p></p>
<p>Developed by Dominic Schuhmacher, Björn Bähre, Nicolas Bonneel, Carsten Gottschlich, Valentin Hartmann, Florian Heinemann, Bernhard Schmitzer, Jörn Schrieber.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
  <p class="preferably">Using <a href="https://preferably.amirmasoudabdol.name/?source=footer" class="external-link">preferably</a> template.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
